import{A as pa,r as S,a as L,cV as ma,a5 as _a,U as ga,p as j,o as h,v as e,B as n,n as D,ac as F,C as a,O as fa,J as c,t as T,E as ha,cW as va,N as H,ah as O,I as ba,bA as ka,L as ya,M as wa,K as p,ad as Ea,G as xa,ay as B,D as Ca,F as Sa}from"./id-Cr8V6t1X.js";import{a as Da,E as Ta}from"./index-Dl373e-q.js";import{E as Ba}from"./index-DDayC8m2.js";import{E as Ia,a as Va}from"./index-J-xe_PTj.js";import{E as Ma}from"./index-xlrtmhen.js";import{E as La}from"./index-yBxktac0.js";import{E as Ua,a as $a}from"./index-DB-t4fgh.js";import{E as Pa}from"./index-Dul2G-l6.js";import{v as za}from"./directive-ClyaBT15.js";import{E as Ka}from"./index-COHakRvd.js";import{E as _}from"./index-CgMgMsvk.js";import{E as U}from"./index-tWq12LAA.js";import{E as $}from"./index-oW4NPyMB.js";import"./typescript-Bp3YSIOJ.js";import"./event-BB_Ol6Sd.js";import"./index-He-E5LR5.js";import"./strings-Cd1Oj1OU.js";import"./index-cvh5LgNC.js";import"./_Uint8Array-Bxcm0ZBW.js";import"./scroll-tt70BtCB.js";import"./_baseIteratee--yf6R2z-.js";import"./vnode-CzLQwVSd.js";import"./index-CJ3TjzBC.js";import"./_initCloneObject-KuTjguNH.js";import"./isArrayLikeObject-B07oKPOd.js";import"./index-CCbbBko3.js";import"./validator-7KSO9w5A.js";const y=w=>(Ca("data-v-1bb01fda"),w=w(),Sa(),w),Na={class:"content"},Aa={class:"content-heading d-flex justify-content-between align-items-center"},Ga=y(()=>n("div",null,[n("h2",{class:"h4 mb-0"},"Kelola Lamaran"),n("small",{class:"text-muted"},"Kelola dan pantau semua lamaran pekerjaan")],-1)),ja={class:"space-x-1"},Fa=y(()=>n("i",{class:"fa fa-download me-1"},null,-1)),Ha={class:"block block-rounded"},Oa=y(()=>n("div",{class:"block-header block-header-default"},[n("h3",{class:"block-title"},[n("i",{class:"fa fa-filter me-2"}),c(" Filter & Pencarian ")])],-1)),Ra={class:"block-content pb-4"},qa={class:"d-flex gap-2"},Ya=y(()=>n("i",{class:"fa fa-refresh me-1"},null,-1)),Ja={key:0,class:"block block-rounded"},Wa={class:"block-content"},Qa={class:"d-flex gap-2 mt-2"},Xa={class:"block block-rounded"},Za={class:"block-content p-0"},ae={class:"fw-medium"},ee={class:"text-muted"},te={class:"fw-medium"},oe={class:"text-muted"},le={class:"d-flex gap-1"},ne=y(()=>n("i",{class:"fa fa-cog"},null,-1)),se={key:0,class:"block-content p-2"},re={class:"d-flex justify-content-between align-items-center"},ie={class:"text-muted"},ce={__name:"Index",setup(w){const I=S(!1),V=S(!1),P=S([]),m=S([]),d=L({q:"",status:"",tanggal_dari:"",tanggal_sampai:""}),s=L({current_page:1,per_page:15,total:0,from:0,to:0}),E=L({sort:"id",sortDir:"desc"}),x={pending:"Menunggu Review",diterima:"Diterima",ditolak:"Ditolak",interview:"Tahap Interview",medical:"Medical Check Up",pelatihan:"Pelatihan",siap:"Siap Berangkat",selesai:"Selesai"},R=o=>x[o]||o,q=o=>({pending:"warning",diterima:"success",ditolak:"danger",interview:"primary",medical:"info",pelatihan:"",siap:"success",selesai:"success"})[o]||"",Y=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),u=async()=>{I.value=!0;try{const o={page:s.current_page,limit:s.per_page,sort:E.sort,sortDir:E.sortDir,...d},l=await B.get(route("admin.lamaran.data"),{params:o});P.value=l.data.data,s.current_page=l.data.current_page,s.per_page=l.data.per_page,s.total=l.data.total,s.from=l.data.from,s.to=l.data.to}catch(o){console.error("Error loading data:",o),_.error("Gagal memuat data")}finally{I.value=!1}},J=ma.debounce(()=>{s.current_page=1,u()},500),W=o=>{m.value=o},Q=({prop:o,order:l})=>{E.sort=o,E.sortDir=l==="ascending"?"asc":"desc",u()},X=o=>{s.current_page=o,u()},Z=()=>{Object.keys(d).forEach(o=>{d[o]=""}),s.current_page=1,u()},M=async(o,l)=>{let r=null;if(l==="ditolak")try{const{value:v}=await U.prompt("Alasan penolakan:","Tolak Lamaran",{confirmButtonText:"Tolak",cancelButtonText:"Batal",inputType:"textarea"});r=v}catch{return}const C=$.service({lock:!0,text:"Memperbarui status..."});try{await B.post(route("admin.lamaran.update-status",o),{status:l,catatan:r}),_.success("Status berhasil diperbarui"),u()}catch(v){console.error("Error updating status:",v),_.error("Gagal memperbarui status")}finally{C.close()}},aa=async o=>{if(m.value.length!==0)try{await U.confirm(`Ubah status ${m.value.length} lamaran menjadi "${x[o]}"?`,"Konfirmasi",{confirmButtonText:"Ya, Ubah",cancelButtonText:"Batal",type:"warning"});const l=$.service({lock:!0,text:"Memperbarui status..."});try{await B.post(route("admin.lamaran.bulk-update-status"),{ids:m.value.map(r=>r.id),status:o}),_.success(`${m.value.length} lamaran berhasil diperbarui`),m.value=[],u()}catch(r){console.error("Error bulk updating:",r),_.error("Gagal memperbarui status")}finally{l.close()}}catch{}},ea=async o=>{try{await U.confirm("Hapus lamaran ini? Tindakan ini tidak dapat dibatalkan.","Konfirmasi Hapus",{confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",type:"error"});const l=$.service({lock:!0,text:"Menghapus..."});try{await B.delete(route("admin.lamaran.destroy",o)),_.success("Lamaran berhasil dihapus"),u()}catch(r){console.error("Error deleting:",r),_.error("Gagal menghapus lamaran")}finally{l.close()}}catch{}},ta=async()=>{V.value=!0;try{const o={...d};window.open(route("admin.lamaran.export",o)),_.success("Export dimulai, file akan didownload secara otomatis")}catch(o){console.error("Error exporting:",o),_.error("Gagal mengexport data")}finally{V.value=!1}};return _a(()=>{u()}),(o,l)=>{const r=fa,C=ha,v=Ba,b=Ta,oa=Va,la=Ia,z=Ma,na=Da,k=wa,K=ya,N=ba,sa=La,g=$a,ra=Pa,ia=Ua,ca=Ka,da=ga("base-layout"),ua=za;return h(),j(da,{title:"Kelola Lamaran"},{default:e(()=>[n("div",Na,[n("div",Aa,[Ga,n("div",ja,[a(r,{type:"success",onClick:ta,loading:V.value},{default:e(()=>[Fa,c(" Export ")]),_:1},8,["loading"])])]),n("div",Ha,[Oa,n("div",Ra,[a(na,{gutter:16},{default:e(()=>[a(b,{span:6},{default:e(()=>[a(v,{modelValue:d.q,"onUpdate:modelValue":l[0]||(l[0]=t=>d.q=t),placeholder:"Cari nama, email, NIK...",onInput:T(J),clearable:""},{prefix:e(()=>[a(C,null,{default:e(()=>[a(T(va))]),_:1})]),_:1},8,["modelValue","onInput"])]),_:1}),a(b,{span:5},{default:e(()=>[a(la,{modelValue:d.status,"onUpdate:modelValue":l[1]||(l[1]=t=>d.status=t),placeholder:"Status",onChange:u,clearable:""},{default:e(()=>[(h(),D(H,null,O(x,(t,i)=>a(oa,{key:i,label:t,value:i},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(b,{span:5},{default:e(()=>[a(z,{modelValue:d.tanggal_dari,"onUpdate:modelValue":l[2]||(l[2]=t=>d.tanggal_dari=t),type:"date",placeholder:"Tanggal Dari",onChange:u,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(b,{span:5},{default:e(()=>[a(z,{modelValue:d.tanggal_sampai,"onUpdate:modelValue":l[3]||(l[3]=t=>d.tanggal_sampai=t),type:"date",placeholder:"Tanggal Sampai",onChange:u,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(b,{span:3},{default:e(()=>[n("div",qa,[a(r,{onClick:Z,type:"default"},{default:e(()=>[Ya,c(" Reset ")]),_:1})])]),_:1})]),_:1})])]),m.value.length>0?(h(),D("div",Ja,[n("div",Wa,[a(sa,{title:`${m.value.length} lamaran dipilih`,type:"info","show-icon":"",closable:!1},{default:e(()=>[n("div",Qa,[a(N,{trigger:"click"},{dropdown:e(()=>[a(K,null,{default:e(()=>[(h(),D(H,null,O(x,(t,i)=>a(k,{key:i,onClick:f=>aa(i)},{default:e(()=>[c(p(t),1)]),_:2},1032,["onClick"])),64))]),_:1})]),default:e(()=>[a(r,{type:"primary",size:"small"},{default:e(()=>[c(" Ubah Status Massal "),a(C,{class:"el-icon--right"},{default:e(()=>[a(T(ka))]),_:1})]),_:1})]),_:1}),a(r,{onClick:l[4]||(l[4]=t=>m.value=[]),size:"small"},{default:e(()=>[c(" Batal Pilih ")]),_:1})])]),_:1},8,["title"])])])):F("",!0),n("div",Xa,[n("div",Za,[Ea((h(),j(ia,{data:P.value,border:"",style:{width:"100%"},onSelectionChange:W,onSortChange:Q},{default:e(()=>[a(g,{type:"selection",width:"55"}),a(g,{prop:"id",label:"ID",width:"80",sortable:"custom"}),a(g,{prop:"user.detail.nama",label:"Nama Pelamar","min-width":"180"},{default:e(({row:t})=>{var i,f,A,G;return[n("div",null,[n("div",ae,p(((f=(i=t.user)==null?void 0:i.detail)==null?void 0:f.nama)||((A=t.user)==null?void 0:A.nama)),1),n("small",ee,p((G=t.user)==null?void 0:G.email),1)])]}),_:1}),a(g,{prop:"lowongan.posisi",label:"Posisi","min-width":"160"},{default:e(({row:t})=>{var i,f;return[n("div",null,[n("div",te,p((i=t.lowongan)==null?void 0:i.posisi),1),n("small",oe,p((f=t.lowongan)==null?void 0:f.perusahaan),1)])]}),_:1}),a(g,{prop:"tanggal_lamaran",label:"Tanggal",width:"120",sortable:"custom"},{default:e(({row:t})=>[c(p(Y(t.tanggal_lamaran)),1)]),_:1}),a(g,{prop:"status",label:"Status",width:"140"},{default:e(({row:t})=>[a(ra,{type:q(t.status),size:"small"},{default:e(()=>[c(p(R(t.status)),1)]),_:2},1032,["type"])]),_:1}),a(g,{label:"Aksi",width:"160",fixed:"right"},{default:e(({row:t})=>[n("div",le,[a(r,{tag:T(xa),href:o.route("admin.lamaran.show",t.id),type:"primary",size:"small"},{default:e(()=>[c(" Detail ")]),_:2},1032,["tag","href"]),a(N,{trigger:"click"},{dropdown:e(()=>[a(K,null,{default:e(()=>[a(k,{onClick:i=>M(t.id,"diterima")},{default:e(()=>[c(" Terima ")]),_:2},1032,["onClick"]),a(k,{onClick:i=>M(t.id,"ditolak")},{default:e(()=>[c(" Tolak ")]),_:2},1032,["onClick"]),a(k,{onClick:i=>M(t.id,"interview")},{default:e(()=>[c(" Set Interview ")]),_:2},1032,["onClick"]),a(k,{divided:"",onClick:i=>ea(t.id),class:"text-danger"},{default:e(()=>[c(" Hapus ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:e(()=>[a(r,{type:"warning",size:"small"},{default:e(()=>[ne]),_:1})]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[ua,I.value]])]),s.total>0?(h(),D("div",se,[n("div",re,[n("div",ie," Menampilkan "+p(s.from)+" - "+p(s.to)+" dari "+p(s.total)+" data ",1),a(ca,{"current-page":s.current_page,"onUpdate:currentPage":l[5]||(l[5]=t=>s.current_page=t),"page-size":s.per_page,total:s.total,onCurrentChange:X,layout:"prev, pager, next",background:""},null,8,["current-page","page-size","total"])])])):F("",!0)])])]),_:1})}}},ze=pa(ce,[["__scopeId","data-v-1bb01fda"]]);export{ze as default};
