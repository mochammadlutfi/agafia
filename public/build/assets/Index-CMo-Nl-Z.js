import{A as ma,r as D,a as $,cV as _a,a5 as ga,U as fa,p as A,o as v,v as t,B as n,n as T,ac as O,C as a,O as ha,J as c,t as B,E as ka,cW as va,N as F,ah as H,I as ba,bA as ya,L as wa,M as Ea,K as p,ad as xa,G as Ca,ay as x,D as Sa,F as Da}from"./id-DZ6E98LX.js";import{a as Ta,E as Ba}from"./index-D85PyAJr.js";import{E as Ia}from"./index-m109sE3g.js";import{E as Va,a as La}from"./index-qO5mJ27J.js";import{E as Ma}from"./index-DN2wI4SX.js";import{E as $a}from"./index-4QfUkk1D.js";import{E as Ua,a as Pa}from"./index-CB10fu27.js";import{E as Ka}from"./index-DgLHlBso.js";import{v as Na}from"./directive-BjZET4Sh.js";import{E as ja}from"./index-BIs_6JMW.js";import{E as m}from"./index-DXRNVpB4.js";import{E as I}from"./index-D5fiSYvl.js";import{E as U}from"./index-C3gEsX6N.js";import"./typescript-Bp3YSIOJ.js";import"./event-BB_Ol6Sd.js";import"./index-BplxyxpN.js";import"./strings-C4jz-Ott.js";import"./index-BcOthcJk.js";import"./_Uint8Array-CYg2ylQ0.js";import"./scroll-UPpyscUS.js";import"./_baseIteratee-Dp1U_fHn.js";import"./vnode-DF80yfNV.js";import"./index-oaTnzhwA.js";import"./_initCloneObject-DsNTB0Yl.js";import"./isArrayLikeObject-lwpBDXMO.js";import"./index-CLUF9wmC.js";import"./validator-DKl5edD1.js";const b=C=>(Sa("data-v-717642c6"),C=C(),Da(),C),za={class:"content"},Ga={class:"content-heading d-flex justify-content-between align-items-center"},Aa=b(()=>n("div",null,[n("h2",{class:"h4 mb-0"},"Kelola Lamaran"),n("small",{class:"text-muted"},"Kelola dan pantau semua lamaran pekerjaan")],-1)),Oa={class:"space-x-1"},Fa=b(()=>n("i",{class:"fa fa-download me-1"},null,-1)),Ha={class:"block block-rounded"},Ra=b(()=>n("div",{class:"block-header block-header-default"},[n("h3",{class:"block-title"},[n("i",{class:"fa fa-filter me-2"}),c(" Filter & Pencarian ")])],-1)),qa={class:"block-content"},Ya={class:"d-flex gap-2"},Ja=b(()=>n("i",{class:"fa fa-refresh me-1"},null,-1)),Wa=b(()=>n("i",{class:"fa fa-chart-bar me-1"},null,-1)),Qa={key:0,class:"block block-rounded"},Xa={class:"block-content"},Za={class:"d-flex gap-2 mt-2"},at={class:"block block-rounded"},tt={class:"block-content p-0"},et={class:"fw-medium"},ot={class:"text-muted"},lt={class:"fw-medium"},nt={class:"text-muted"},st={class:"d-flex gap-1"},rt=b(()=>n("i",{class:"fa fa-cog"},null,-1)),it={key:0,class:"block-content"},ct={class:"d-flex justify-content-between align-items-center"},dt={class:"text-muted"},ut={__name:"Index",setup(C){const V=D(!1),L=D(!1),P=D([]),_=D([]),d=$({q:"",status:"",tanggal_dari:"",tanggal_sampai:""}),r=$({current_page:1,per_page:15,total:0,from:0,to:0}),S=$({sort:"id",sortDir:"desc"}),y={pending:"Menunggu Review",diterima:"Diterima",ditolak:"Ditolak",interview:"Tahap Interview",medical:"Medical Check Up",pelatihan:"Pelatihan",siap:"Siap Berangkat",selesai:"Selesai"},R=e=>y[e]||e,q=e=>({pending:"warning",diterima:"success",ditolak:"danger",interview:"primary",medical:"info",pelatihan:"",siap:"success",selesai:"success"})[e]||"",Y=e=>new Date(e).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),u=async()=>{V.value=!0;try{const e={page:r.current_page,limit:r.per_page,sort:S.sort,sortDir:S.sortDir,...d},l=await x.get(route("admin.lamaran.data"),{params:e});P.value=l.data.data,r.current_page=l.data.current_page,r.per_page=l.data.per_page,r.total=l.data.total,r.from=l.data.from,r.to=l.data.to}catch(e){console.error("Error loading data:",e),m.error("Gagal memuat data")}finally{V.value=!1}},J=_a.debounce(()=>{r.current_page=1,u()},500),W=e=>{_.value=e},Q=({prop:e,order:l})=>{S.sort=e,S.sortDir=l==="ascending"?"asc":"desc",u()},X=e=>{r.current_page=e,u()},Z=()=>{Object.keys(d).forEach(e=>{d[e]=""}),r.current_page=1,u()},M=async(e,l)=>{let s=null;if(l==="ditolak")try{const{value:f}=await I.prompt("Alasan penolakan:","Tolak Lamaran",{confirmButtonText:"Tolak",cancelButtonText:"Batal",inputType:"textarea"});s=f}catch{return}const h=U.service({lock:!0,text:"Memperbarui status..."});try{await x.post(route("admin.lamaran.update-status",e),{status:l,catatan:s}),m.success("Status berhasil diperbarui"),u()}catch(f){console.error("Error updating status:",f),m.error("Gagal memperbarui status")}finally{h.close()}},aa=async e=>{if(_.value.length!==0)try{await I.confirm(`Ubah status ${_.value.length} lamaran menjadi "${y[e]}"?`,"Konfirmasi",{confirmButtonText:"Ya, Ubah",cancelButtonText:"Batal",type:"warning"});const l=U.service({lock:!0,text:"Memperbarui status..."});try{await x.post(route("admin.lamaran.bulk-update-status"),{ids:_.value.map(s=>s.id),status:e}),m.success(`${_.value.length} lamaran berhasil diperbarui`),_.value=[],u()}catch(s){console.error("Error bulk updating:",s),m.error("Gagal memperbarui status")}finally{l.close()}}catch{}},ta=async e=>{try{await I.confirm("Hapus lamaran ini? Tindakan ini tidak dapat dibatalkan.","Konfirmasi Hapus",{confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",type:"error"});const l=U.service({lock:!0,text:"Menghapus..."});try{await x.delete(route("admin.lamaran.destroy",e)),m.success("Lamaran berhasil dihapus"),u()}catch(s){console.error("Error deleting:",s),m.error("Gagal menghapus lamaran")}finally{l.close()}}catch{}},ea=async()=>{L.value=!0;try{const e={...d};window.open(route("admin.lamaran.export",e)),m.success("Export dimulai, file akan didownload secara otomatis")}catch(e){console.error("Error exporting:",e),m.error("Gagal mengexport data")}finally{L.value=!1}},oa=async()=>{try{const l=(await x.get(route("admin.lamaran.statistics"))).data.stats;let s=`Statistik Lamaran:
`;Object.entries(y).forEach(([h,f])=>{s+=`${f}: ${l[h]||0}
`}),I.alert(s,"Statistik",{confirmButtonText:"OK"})}catch(e){console.error("Error loading statistics:",e),m.error("Gagal memuat statistik")}};return ga(()=>{u()}),(e,l)=>{const s=ha,h=ka,f=Ia,w=Ba,la=La,na=Va,K=Ma,sa=Ta,E=Ea,N=wa,j=ba,ra=$a,g=Pa,ia=Ka,ca=Ua,da=ja,ua=fa("base-layout"),pa=Na;return v(),A(ua,{title:"Kelola Lamaran"},{default:t(()=>[n("div",za,[n("div",Ga,[Aa,n("div",Oa,[a(s,{type:"success",onClick:ea,loading:L.value},{default:t(()=>[Fa,c(" Export ")]),_:1},8,["loading"])])]),n("div",Ha,[Ra,n("div",qa,[a(sa,{gutter:16},{default:t(()=>[a(w,{span:6},{default:t(()=>[a(f,{modelValue:d.q,"onUpdate:modelValue":l[0]||(l[0]=o=>d.q=o),placeholder:"Cari nama, email, NIK...",onInput:B(J),clearable:""},{prefix:t(()=>[a(h,null,{default:t(()=>[a(B(va))]),_:1})]),_:1},8,["modelValue","onInput"])]),_:1}),a(w,{span:4},{default:t(()=>[a(na,{modelValue:d.status,"onUpdate:modelValue":l[1]||(l[1]=o=>d.status=o),placeholder:"Status",onChange:u,clearable:""},{default:t(()=>[(v(),T(F,null,H(y,(o,i)=>a(la,{key:i,label:o,value:i},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(w,{span:4},{default:t(()=>[a(K,{modelValue:d.tanggal_dari,"onUpdate:modelValue":l[2]||(l[2]=o=>d.tanggal_dari=o),type:"date",placeholder:"Tanggal Dari",onChange:u,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(w,{span:4},{default:t(()=>[a(K,{modelValue:d.tanggal_sampai,"onUpdate:modelValue":l[3]||(l[3]=o=>d.tanggal_sampai=o),type:"date",placeholder:"Tanggal Sampai",onChange:u,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(w,{span:6},{default:t(()=>[n("div",Ya,[a(s,{onClick:Z,type:"default"},{default:t(()=>[Ja,c(" Reset ")]),_:1}),a(s,{onClick:oa,type:"info"},{default:t(()=>[Wa,c(" Statistik ")]),_:1})])]),_:1})]),_:1})])]),_.value.length>0?(v(),T("div",Qa,[n("div",Xa,[a(ra,{title:`${_.value.length} lamaran dipilih`,type:"info","show-icon":"",closable:!1},{default:t(()=>[n("div",Za,[a(j,{trigger:"click"},{dropdown:t(()=>[a(N,null,{default:t(()=>[(v(),T(F,null,H(y,(o,i)=>a(E,{key:i,onClick:k=>aa(i)},{default:t(()=>[c(p(o),1)]),_:2},1032,["onClick"])),64))]),_:1})]),default:t(()=>[a(s,{type:"primary",size:"small"},{default:t(()=>[c(" Ubah Status Massal "),a(h,{class:"el-icon--right"},{default:t(()=>[a(B(ya))]),_:1})]),_:1})]),_:1}),a(s,{onClick:l[4]||(l[4]=o=>_.value=[]),size:"small"},{default:t(()=>[c(" Batal Pilih ")]),_:1})])]),_:1},8,["title"])])])):O("",!0),n("div",at,[n("div",tt,[xa((v(),A(ca,{data:P.value,border:"",style:{width:"100%"},onSelectionChange:W,onSortChange:Q},{default:t(()=>[a(g,{type:"selection",width:"55"}),a(g,{prop:"id",label:"ID",width:"80",sortable:"custom"}),a(g,{prop:"user.detail.nama",label:"Nama Pelamar","min-width":"180"},{default:t(({row:o})=>{var i,k,z,G;return[n("div",null,[n("div",et,p(((k=(i=o.user)==null?void 0:i.detail)==null?void 0:k.nama)||((z=o.user)==null?void 0:z.nama)),1),n("small",ot,p((G=o.user)==null?void 0:G.email),1)])]}),_:1}),a(g,{prop:"lowongan.posisi",label:"Posisi","min-width":"160"},{default:t(({row:o})=>{var i,k;return[n("div",null,[n("div",lt,p((i=o.lowongan)==null?void 0:i.posisi),1),n("small",nt,p((k=o.lowongan)==null?void 0:k.perusahaan),1)])]}),_:1}),a(g,{prop:"lowongan.negara_tujuan",label:"Negara",width:"120"}),a(g,{prop:"tanggal_lamaran",label:"Tanggal",width:"120",sortable:"custom"},{default:t(({row:o})=>[c(p(Y(o.tanggal_lamaran)),1)]),_:1}),a(g,{prop:"status",label:"Status",width:"140"},{default:t(({row:o})=>[a(ia,{type:q(o.status),size:"small"},{default:t(()=>[c(p(R(o.status)),1)]),_:2},1032,["type"])]),_:1}),a(g,{label:"Aksi",width:"160",fixed:"right"},{default:t(({row:o})=>[n("div",st,[a(s,{tag:B(Ca),href:e.route("admin.lamaran.show",o.id),type:"primary",size:"small"},{default:t(()=>[c(" Detail ")]),_:2},1032,["tag","href"]),a(j,{trigger:"click"},{dropdown:t(()=>[a(N,null,{default:t(()=>[a(E,{onClick:i=>M(o.id,"diterima")},{default:t(()=>[c(" Terima ")]),_:2},1032,["onClick"]),a(E,{onClick:i=>M(o.id,"ditolak")},{default:t(()=>[c(" Tolak ")]),_:2},1032,["onClick"]),a(E,{onClick:i=>M(o.id,"interview")},{default:t(()=>[c(" Set Interview ")]),_:2},1032,["onClick"]),a(E,{divided:"",onClick:i=>ta(o.id),class:"text-danger"},{default:t(()=>[c(" Hapus ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[a(s,{type:"warning",size:"small"},{default:t(()=>[rt]),_:1})]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[pa,V.value]])]),r.total>0?(v(),T("div",it,[n("div",ct,[n("div",dt," Menampilkan "+p(r.from)+" - "+p(r.to)+" dari "+p(r.total)+" data ",1),a(da,{"current-page":r.current_page,"onUpdate:currentPage":l[5]||(l[5]=o=>r.current_page=o),"page-size":r.per_page,total:r.total,onCurrentChange:X,layout:"prev, pager, next",background:""},null,8,["current-page","page-size","total"])])])):O("",!0)])])]),_:1})}}},jt=ma(ut,[["__scopeId","data-v-717642c6"]]);export{jt as default};
