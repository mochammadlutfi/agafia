import{A as ma,r,a as K,aC as T,a5 as fa,U as _a,p as E,o as w,v as l,B as i,C as a,ad as R,O as ga,J as u,n as ha,t as A,K as p,I as va,L as ba,M as wa,G as ya,H as O,ac as I,D as ka,F as Ea}from"./id-B6nzwgpI.js";import{h as Va}from"./moment-D15uM1gO.js";import{_ as xa}from"./SelectLamaran-CDUFgzf6.js";import{_ as Ca}from"./SingleFileUpload-oNQ5TemG.js";import{a as Da,E as Ma}from"./index-CNWh6HZ7.js";import{E as Ta,a as ja}from"./index-nMKTPBRL.js";import{E as Sa}from"./index-DMhCjaYJ.js";import{E as Ua,a as Fa}from"./index-cVjCorqK.js";import{E as Ya}from"./index-CS-U25Rj.js";import{E as Ba}from"./index-DLn63ED9.js";import{v as Ia}from"./directive-K_WTEYF8.js";import{E as Pa}from"./index-u7wZ4eP6.js";import{E as Na,a as qa}from"./index-BZwtmcJ_.js";import{E as Ha}from"./index-Vcj5-Pos.js";import{E as La}from"./index-CuUXQnr8.js";import{E as y}from"./index-CWdicLEL.js";import"./typescript-Bp3YSIOJ.js";import"./index-BTTm5nEU.js";import"./_Uint8Array-CGYHTGVX.js";import"./event-BB_Ol6Sd.js";import"./scroll-Dq92vYzH.js";import"./_baseIteratee-CEMChci4.js";import"./vnode-Bjz-F9iQ.js";import"./index-ng22Bdpy.js";import"./_initCloneObject-Du_knNGi.js";import"./isArrayLikeObject-CwVoBkBj.js";import"./index-CzfI5m8E.js";import"./index-CmxPKCL5.js";import"./validator-DGQAUmUB.js";const h=V=>(ka("data-v-f715f8d6"),V=V(),Ea(),V),$a={class:"content"},za={class:"content-heading d-flex justify-content-between align-items-center"},Ka=h(()=>i("span",null,"Medical Checkup",-1)),Ra={class:"space-x-1"},Aa=h(()=>i("i",{class:"fa fa-plus me-2"},null,-1)),Oa={class:"block rounded bordered"},Ga={class:"block-content py-3"},Ja=h(()=>i("span",null,[i("i",{class:"fa fa-search"})],-1)),Qa={class:"block-content p-0"},Wa={class:"fw-medium"},Xa={class:"text-muted"},Za=h(()=>i("i",{class:"fa-solid fa-ellipsis"},null,-1)),ae=h(()=>i("i",{class:"si fa-fw si-eye"},null,-1)),ee=h(()=>i("i",{class:"si fa-fw si-trash"},null,-1)),te=h(()=>i("i",{class:"si fa-fw si-trash"},null,-1)),le={class:"block-content py-2"},oe={class:"my-auto text-xs"},ne={class:"dialog-footer"},P=25,se={__name:"Index",setup(V){const N=r([]),x=r(!0),j=r(""),S=r(0),U=r(0),G=r(0),q=r(1),H=r(0),k=r(!1),C=r(!1),d=r(!1),D=r(),e=K({id:null,lamaran_id:"",nama:"",tanggal:"",hasil:"",status:"pending",catatan:"",file:null}),F=K({lamaran_id:[{required:!0,message:"Pilih lamaran terlebih dahulu",trigger:"change"}],tanggal:[{required:!0,message:"Tanggal medical wajib diisi",trigger:"blur"}],nama:[{required:!0,message:"Nama Faskes wajib diisi",trigger:"blur"}],file:[{required:!0,message:"File wajib diupload",trigger:"change"}],hasil:[{required:!0,message:"Hasil wajib diisi",trigger:"blur"}],status:[{required:!0,message:"Status wajib dipilih",trigger:"change"}]}),J=_.debounce(()=>{x.value=!0,c()},1e3),c=async s=>{try{x.value=!0;const t=await T.get("/admin/medical/data",{params:{page:s||1,limit:P,search:j.value}});t.status===200&&(N.value=t.data.data,q.value=t.data.current_page,S.value=t.data.total,H.value=t.data.per_page,U.value=t.data.from,U.to=t.data.to)}catch(t){console.error(t)}finally{x.value=!1}},Q=s=>{if(s)return Va(String(s)).format("DD MMM YYYY")},W=s=>{switch(s){case"pending":return"warning";case"valid":return"success";default:return"danger"}},X=s=>{c()},Z=()=>{d.value=!1,L(),F.file=[{required:!0,message:"File dokumen wajib diupload",trigger:"change"}],k.value=!0},aa=s=>{d.value=!0,e.id=s.id,e.nama=s.nama,e.tanggal=s.tanggal,e.hasil=s.hasil,e.status=s.status,e.catatan=s.catatan||"",F.file=[],k.value=!0},Y=()=>{var s;(s=D.value)==null||s.resetFields(),L(),k.value=!1},L=()=>{e.id=null,e.lamaran_id="",e.nama="",e.tanggal="",e.hasil="",e.status="pending",e.catatan="",e.file=null},ea=async()=>{D.value&&await D.value.validate(async s=>{var t,m;if(s){C.value=!0;try{const n=new FormData;if(d.value){n.append("_method","PUT"),n.append("nama",e.nama),n.append("tanggal",e.tanggal),n.append("hasil",e.hasil),n.append("status",e.status),e.catatan&&n.append("catatan",e.catatan);const f=await T.post(route("admin.medical.update",{id:e.id}),n,{headers:{"Content-Type":"multipart/form-data"}})}else{n.append("lamaran_id",e.lamaran_id),n.append("nama",e.nama),n.append("tanggal",e.tanggal),n.append("hasil",e.hasil),e.catatan&&n.append("catatan",e.catatan),e.file&&n.append("file",e.file);const f=await T.post(route("admin.medical.store"),n,{headers:{"Content-Type":"multipart/form-data"}})}y.success(d.value?"Data berhasil diupdate!":"Data berhasil ditambahkan!"),Y(),c()}catch(n){if(console.error("Error:",n),(m=(t=n.response)==null?void 0:t.data)!=null&&m.errors){const f=n.response.data.errors;Object.keys(f).forEach(v=>{y.error(f[v][0])})}else y.error("Terjadi kesalahan saat menyimpan data")}finally{C.value=!1}}})},ta=s=>{La.confirm("Data yang dihapus tidak bisa dikembalikan!","Peringatan",{confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal",type:"warning"}).then(async()=>{try{await T.delete(route("admin.medical.delete",{id:s})),y.success("Data berhasil dihapus!"),c()}catch(t){console.error("Error:",t),y.error("Terjadi kesalahan saat menghapus data")}}).catch(()=>{y.info("Penghapusan dibatalkan")})};return fa(()=>{c()}),(s,t)=>{const m=ga,n=ja,f=Ta,v=Ma,M=Sa,$=Da,b=Fa,la=Ya,B=wa,oa=ba,na=va,sa=Ua,ia=Ba,g=qa,ra=Ha,da=Na,ua=Pa,pa=_a("base-layout"),z=Ia;return w(),E(pa,null,{default:l(()=>[i("div",$a,[i("div",za,[Ka,i("div",Ra,[a(m,{type:"primary",onClick:Z},{default:l(()=>[Aa,u(" Tambah Medical Checkup ")]),_:1})])]),R((w(),ha("div",Oa,[i("div",Ga,[a($,{justify:"space-between"},{default:l(()=>[a(v,{span:12},{default:l(()=>[a(f,{modelValue:P,"onUpdate:modelValue":t[0]||(t[0]=o=>P=o),placeholder:"Pilih",style:{width:"110px"},onChange:t[1]||(t[1]=o=>c(1))},{default:l(()=>[a(n,{label:"25",value:"25"}),a(n,{label:"50",value:"50"}),a(n,{label:"100",value:"100"})]),_:1})]),_:1}),a(v,{span:7},{default:l(()=>[a(M,{modelValue:j.value,"onUpdate:modelValue":t[2]||(t[2]=o=>j.value=o),onInput:A(J),clearable:""},{prefix:l(()=>[Ja]),_:1},8,["modelValue","onInput"])]),_:1})]),_:1})]),i("div",Qa,[a(sa,{data:N.value,class:"w-100",onSortChange:X,"header-cell-class-name":"bg-body text-dark"},{default:l(()=>[a(b,{type:"index",width:"50"}),a(b,{label:"Lamaran",width:"200",sortable:""},{default:l(o=>[i("div",null,[i("div",Wa,p(o.row.lamaran.user.nama),1),i("small",Xa,p(o.row.lamaran.lowongan.posisi),1)])]),_:1}),a(b,{prop:"nama",label:"Nama Faskes",sortable:""}),a(b,{label:"Tanggal",prop:"tanggal"},{default:l(o=>[u(p(Q(o.row.tanggal)),1)]),_:1}),a(b,{label:"Status",prop:"status",align:"center",width:"180"},{default:l(o=>[a(la,{type:W(o.row.status),size:"small"},{default:l(()=>[u(p(o.row.status_label),1)]),_:2},1032,["type"])]),_:1}),a(b,{label:"Aksi",align:"center",width:"150"},{default:l(o=>[a(na,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:l(()=>[a(oa,null,{default:l(()=>[a(B,null,{default:l(()=>[a(A(ya),{href:s.route("admin.medical.show",{id:o.row.id}),class:"w-100 d-flex align-items-center justify-content-between space-x-1"},{default:l(()=>[u(" Detail "),ae]),_:2},1032,["href"])]),_:2},1024),a(B,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:O(ca=>aa(o.row),["prevent"])},{default:l(()=>[u(" Ubah "),ee]),_:2},1032,["onClick"]),a(B,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:O(ca=>ta(o.row.id),["prevent"])},{default:l(()=>[u(" Hapus "),te]),_:2},1032,["onClick"])]),_:2},1024)]),default:l(()=>[a(m,null,{default:l(()=>[Za]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])]),i("div",le,[a($,{justify:"space-between"},{default:l(()=>[a(v,{lg:12,class:"d-flex"},{default:l(()=>[i("p",oe,"Menampilkan "+p(U.value)+" sampai "+p(G.value)+" dari "+p(S.value),1)]),_:1}),a(v,{lg:12,class:"text-end"},{default:l(()=>[a(ia,{class:"float-end",background:"",layout:"prev, pager, next","page-size":H.value,total:S.value,"current-page":q.value,onCurrentChange:c},null,8,["page-size","total","current-page"])]),_:1})]),_:1})])])),[[z,x.value]])]),a(ua,{modelValue:k.value,"onUpdate:modelValue":t[10]||(t[10]=o=>k.value=o),title:d.value?"Edit Medical Checkup":"Tambah Medical Checkup",width:"600px","before-close":Y},{footer:l(()=>[i("span",ne,[a(m,{onClick:Y},{default:l(()=>[u("Batal")]),_:1}),a(m,{type:"primary",onClick:ea,loading:C.value},{default:l(()=>[u(p(d.value?"Update":"Simpan"),1)]),_:1},8,["loading"])])]),default:l(()=>[R((w(),E(da,{ref_key:"formRef",ref:D,model:e,rules:F,"label-position":"top"},{default:l(()=>[d.value?I("",!0):(w(),E(g,{key:0,label:"Pilih Lamaran",prop:"lamaran_id"},{default:l(()=>[a(xa,{modelValue:e.lamaran_id,"onUpdate:modelValue":t[3]||(t[3]=o=>e.lamaran_id=o),placeholder:"Pilih lamaran untuk medical checkup",style:{width:"100%"}},null,8,["modelValue"])]),_:1})),a(g,{label:"Tanggal Medical",prop:"tanggal"},{default:l(()=>[a(ra,{modelValue:e.tanggal,"onUpdate:modelValue":t[4]||(t[4]=o=>e.tanggal=o),type:"date",placeholder:"Pilih tanggal",format:"DD/MM/YYYY","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(g,{label:"Nama Fasilitas Kesehatan",prop:"nama"},{default:l(()=>[a(M,{modelValue:e.nama,"onUpdate:modelValue":t[5]||(t[5]=o=>e.nama=o),placeholder:"Nama Fasilitas Kesehatan (misal: Rumah Sakit Bunga, dll)"},null,8,["modelValue"])]),_:1}),d.value?I("",!0):(w(),E(g,{key:1,label:"Upload File",prop:"file"},{default:l(()=>[a(Ca,{modelValue:e.file,"onUpdate:modelValue":t[6]||(t[6]=o=>e.file=o)},null,8,["modelValue"])]),_:1})),a(g,{label:"Hasil",prop:"hasil"},{default:l(()=>[a(M,{modelValue:e.hasil,"onUpdate:modelValue":t[7]||(t[7]=o=>e.hasil=o),placeholder:"Hasil medical check"},null,8,["modelValue"])]),_:1}),d.value?(w(),E(g,{key:2,label:"Status",prop:"status"},{default:l(()=>[a(f,{modelValue:e.status,"onUpdate:modelValue":t[8]||(t[8]=o=>e.status=o),placeholder:"Pilih status",style:{width:"100%"}},{default:l(()=>[a(n,{label:"Pending",value:"pending"}),a(n,{label:"Valid",value:"valid"}),a(n,{label:"Tidak Valid",value:"tidak_valid"})]),_:1},8,["modelValue"])]),_:1})):I("",!0),a(g,{label:"Catatan"},{default:l(()=>[a(M,{modelValue:e.catatan,"onUpdate:modelValue":t[9]||(t[9]=o=>e.catatan=o),type:"textarea",rows:3,placeholder:"Catatan tambahan (opsional)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[z,C.value]])]),_:1},8,["modelValue","title"])]),_:1})}}},Ie=ma(se,[["__scopeId","data-v-f715f8d6"]]);export{Ie as default};
