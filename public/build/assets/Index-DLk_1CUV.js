import{A as wa,r as E,a as F,cV as Ea,a5 as xa,U as Da,p as aa,o as v,v as e,B as n,C as a,n as y,ac as S,I as Ca,O as Va,J as r,E as Sa,t as P,bD as ea,L as Pa,M as Ma,cW as Ta,N as K,ah as N,K as u,ad as Ba,G as Fa,aC as I,D as Ia,F as Ya}from"./id-C9hYMH1B.js";import{a as La,E as Ua}from"./index-BeNpYn1C.js";import{E as $a}from"./index-wNIjKzA9.js";import{E as Ga,a as ja}from"./index-B7oIPsZq.js";import{E as za}from"./index-Cim0JZIT.js";import{E as Aa}from"./index-DosL4iqp.js";import{E as Ka,a as Na}from"./index--er-YjEa.js";import{E as Ra}from"./index-DpPGiUdG.js";import{v as Oa}from"./directive-BsyuVYtP.js";import{E as Ha}from"./index-ZMuYLrAD.js";import{E as qa}from"./index-lsY82Nw0.js";import{E as Ja,a as Wa}from"./index-DVyup1uO.js";import{E as g}from"./index-Cp4QcoMp.js";import{E as R}from"./index-DbSZ3Hba.js";import{E as O}from"./index-CCmghcp5.js";import"./typescript-Bp3YSIOJ.js";import"./event-BB_Ol6Sd.js";import"./index-Cgih6hI8.js";import"./index-GOrWjhdZ.js";import"./_Uint8Array-DpVHxJNR.js";import"./scroll-Do2KWamR.js";import"./_baseIteratee-DSxqpu-w.js";import"./vnode-C8DSHsEw.js";import"./index-B8Y3CyFA.js";import"./_initCloneObject-iXJsdRzn.js";import"./isArrayLikeObject-CsAwkISA.js";import"./index-CyWwbtSv.js";import"./validator-KIENhd6v.js";const f=M=>(Ia("data-v-4288924b"),M=M(),Ya(),M),Qa={class:"content"},Xa={class:"content-heading d-flex justify-content-between align-items-center"},Za=f(()=>n("div",null,[n("h2",{class:"h4 mb-0"},"Kelola Lamaran"),n("small",{class:"text-muted"},"Kelola dan pantau semua lamaran pekerjaan")],-1)),ae={class:"space-x-1"},ee=f(()=>n("i",{class:"fa fa-download me-1"},null,-1)),te=f(()=>n("i",{class:"fa fa-file-excel-o me-2"},null,-1)),le=f(()=>n("i",{class:"fa fa-file-pdf-o me-2"},null,-1)),oe={class:"block block-rounded"},ne=f(()=>n("div",{class:"block-header block-header-default"},[n("h3",{class:"block-title"},[n("i",{class:"fa fa-filter me-2"}),r(" Filter & Pencarian ")])],-1)),se={class:"block-content pb-4"},re={class:"d-flex gap-2"},ie=f(()=>n("i",{class:"fa fa-refresh me-1"},null,-1)),de={key:0,class:"block block-rounded"},ce={class:"block-content"},ue={class:"d-flex gap-2 mt-2"},pe={class:"block block-rounded"},me={class:"block-content p-0"},_e={class:"fw-medium"},ge={class:"text-muted"},fe={class:"fw-medium"},he={class:"text-muted"},ve={class:"d-flex gap-1"},ke=f(()=>n("i",{class:"fa fa-cog"},null,-1)),be={key:0,class:"block-content p-2"},ye={class:"d-flex justify-content-between align-items-center"},we={class:"text-muted"},Ee={class:"border rounded p-3 bg-light"},xe={class:"small text-muted"},De={key:0},Ce=f(()=>n("strong",null,"Status:",-1)),Ve={key:1},Se=f(()=>n("strong",null,"Periode:",-1)),Pe={key:2},Me=f(()=>n("em",null,"Semua data lamaran akan disertakan dalam laporan",-1)),Te=[Me],Be={class:"dialog-footer"},Fe=f(()=>n("i",{class:"fa fa-file-pdf-o me-1"},null,-1)),Ie={__name:"Index",setup(M){const Y=E(!1),L=E(!1),U=E(!1),C=E(!1),H=E([]),k=E([]),ta=E(),p=F({q:"",status:"",tanggal_dari:"",tanggal_sampai:""}),i=F({current_page:1,per_page:15,total:0,from:0,to:0}),T=F({sort:"id",sortDir:"desc"}),s=F({status:"",lowongan_id:"",tanggal_dari:"",tanggal_sampai:""}),x={pending:"Menunggu Review",diterima:"Diterima",ditolak:"Ditolak",interview:"Tahap Interview",medical:"Medical Check Up",pelatihan:"Pelatihan",siap:"Siap Berangkat",selesai:"Selesai"},la=o=>x[o]||o,oa=o=>({pending:"warning",diterima:"success",ditolak:"danger",interview:"primary",medical:"info",pelatihan:"",siap:"success",selesai:"success"})[o]||"",$=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),m=async()=>{Y.value=!0;try{const o={page:i.current_page,limit:i.per_page,sort:T.sort,sortDir:T.sortDir,...p},t=await I.get(route("admin.lamaran.data"),{params:o});H.value=t.data.data,i.current_page=t.data.current_page,i.per_page=t.data.per_page,i.total=t.data.total,i.from=t.data.from,i.to=t.data.to}catch(o){console.error("Error loading data:",o),g.error("Gagal memuat data")}finally{Y.value=!1}},na=Ea.debounce(()=>{i.current_page=1,m()},500),sa=o=>{k.value=o},ra=({prop:o,order:t})=>{T.sort=o,T.sortDir=t==="ascending"?"asc":"desc",m()},ia=o=>{i.current_page=o,m()},da=()=>{Object.keys(p).forEach(o=>{p[o]=""}),i.current_page=1,m()},G=async(o,t)=>{let c=null;if(t==="ditolak")try{const{value:_}=await R.prompt("Alasan penolakan:","Tolak Lamaran",{confirmButtonText:"Tolak",cancelButtonText:"Batal",inputType:"textarea"});c=_}catch{return}const h=O.service({lock:!0,text:"Memperbarui status..."});try{await I.post(route("admin.lamaran.update-status",o),{status:t,catatan:c}),g.success("Status berhasil diperbarui"),m()}catch(_){console.error("Error updating status:",_),g.error("Gagal memperbarui status")}finally{h.close()}},ca=async o=>{if(k.value.length!==0)try{await R.confirm(`Ubah status ${k.value.length} lamaran menjadi "${x[o]}"?`,"Konfirmasi",{confirmButtonText:"Ya, Ubah",cancelButtonText:"Batal",type:"warning"});const t=O.service({lock:!0,text:"Memperbarui status..."});try{await I.post(route("admin.lamaran.bulk-update-status"),{ids:k.value.map(c=>c.id),status:o}),g.success(`${k.value.length} lamaran berhasil diperbarui`),k.value=[],m()}catch(c){console.error("Error bulk updating:",c),g.error("Gagal memperbarui status")}finally{t.close()}}catch{}},ua=async o=>{try{await R.confirm("Hapus lamaran ini? Tindakan ini tidak dapat dibatalkan.","Konfirmasi Hapus",{confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",type:"error"});const t=O.service({lock:!0,text:"Menghapus..."});try{await I.delete(route("admin.lamaran.destroy",o)),g.success("Lamaran berhasil dihapus"),m()}catch(c){console.error("Error deleting:",c),g.error("Gagal menghapus lamaran")}finally{t.close()}}catch{}},pa=async()=>{L.value=!0;try{const o={...p};window.open(route("admin.lamaran.export",o)),g.success("Export dimulai, file akan didownload secara otomatis")}catch(o){console.error("Error exporting:",o),g.error("Gagal mengexport data")}finally{L.value=!1}},ma=async()=>{U.value=!0;try{const o=new URLSearchParams;Object.keys(s).forEach(c=>{s[c]&&o.append(c,s[c])});const t=route("admin.lamaran.export-pdf")+(o.toString()?"?"+o.toString():"");window.open(t,"_blank"),g.success("PDF sedang diproses, file akan didownload secara otomatis"),C.value=!1}catch(o){console.error("Error exporting PDF:",o),g.error("Gagal mengexport PDF")}finally{U.value=!1}},_a=o=>{Object.keys(s).forEach(t=>{s[t]=""}),o()};return xa(()=>{m()}),(o,t)=>{const c=Sa,h=Va,_=Ma,j=Pa,z=Ca,q=$a,b=Ua,J=ja,W=Ga,B=za,A=La,Q=Aa,w=Na,ga=Ra,fa=Ka,ha=Ha,V=Wa,va=Ja,ka=qa,ba=Da("base-layout"),ya=Oa;return v(),aa(ba,{title:"Kelola Lamaran"},{default:e(()=>[n("div",Qa,[n("div",Xa,[Za,n("div",ae,[a(z,{trigger:"click"},{dropdown:e(()=>[a(j,null,{default:e(()=>[a(_,{onClick:pa},{default:e(()=>[te,r(" Export CSV ")]),_:1}),a(_,{onClick:t[0]||(t[0]=l=>C.value=!0)},{default:e(()=>[le,r(" Export PDF ")]),_:1})]),_:1})]),default:e(()=>[a(h,{type:"success",loading:L.value},{default:e(()=>[ee,r(" Export "),a(c,{class:"el-icon--right"},{default:e(()=>[a(P(ea))]),_:1})]),_:1},8,["loading"])]),_:1})])]),n("div",oe,[ne,n("div",se,[a(A,{gutter:16},{default:e(()=>[a(b,{span:6},{default:e(()=>[a(q,{modelValue:p.q,"onUpdate:modelValue":t[1]||(t[1]=l=>p.q=l),placeholder:"Cari nama, email, NIK...",onInput:P(na),clearable:""},{prefix:e(()=>[a(c,null,{default:e(()=>[a(P(Ta))]),_:1})]),_:1},8,["modelValue","onInput"])]),_:1}),a(b,{span:5},{default:e(()=>[a(W,{modelValue:p.status,"onUpdate:modelValue":t[2]||(t[2]=l=>p.status=l),placeholder:"Status",onChange:m,clearable:""},{default:e(()=>[(v(),y(K,null,N(x,(l,d)=>a(J,{key:d,label:l,value:d},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(b,{span:5},{default:e(()=>[a(B,{modelValue:p.tanggal_dari,"onUpdate:modelValue":t[3]||(t[3]=l=>p.tanggal_dari=l),type:"date",placeholder:"Tanggal Dari",onChange:m,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(b,{span:5},{default:e(()=>[a(B,{modelValue:p.tanggal_sampai,"onUpdate:modelValue":t[4]||(t[4]=l=>p.tanggal_sampai=l),type:"date",placeholder:"Tanggal Sampai",onChange:m,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(b,{span:3},{default:e(()=>[n("div",re,[a(h,{onClick:da,type:"default"},{default:e(()=>[ie,r(" Reset ")]),_:1})])]),_:1})]),_:1})])]),k.value.length>0?(v(),y("div",de,[n("div",ce,[a(Q,{title:`${k.value.length} lamaran dipilih`,type:"info","show-icon":"",closable:!1},{default:e(()=>[n("div",ue,[a(z,{trigger:"click"},{dropdown:e(()=>[a(j,null,{default:e(()=>[(v(),y(K,null,N(x,(l,d)=>a(_,{key:d,onClick:D=>ca(d)},{default:e(()=>[r(u(l),1)]),_:2},1032,["onClick"])),64))]),_:1})]),default:e(()=>[a(h,{type:"primary",size:"small"},{default:e(()=>[r(" Ubah Status Massal "),a(c,{class:"el-icon--right"},{default:e(()=>[a(P(ea))]),_:1})]),_:1})]),_:1}),a(h,{onClick:t[5]||(t[5]=l=>k.value=[]),size:"small"},{default:e(()=>[r(" Batal Pilih ")]),_:1})])]),_:1},8,["title"])])])):S("",!0),n("div",pe,[n("div",me,[Ba((v(),aa(fa,{data:H.value,border:"",style:{width:"100%"},onSelectionChange:sa,onSortChange:ra},{default:e(()=>[a(w,{type:"selection",width:"55"}),a(w,{prop:"id",label:"ID",width:"80",sortable:"custom"}),a(w,{prop:"user.detail.nama",label:"Nama Pelamar","min-width":"180"},{default:e(({row:l})=>{var d,D,X,Z;return[n("div",null,[n("div",_e,u(((D=(d=l.user)==null?void 0:d.detail)==null?void 0:D.nama)||((X=l.user)==null?void 0:X.nama)),1),n("small",ge,u((Z=l.user)==null?void 0:Z.email),1)])]}),_:1}),a(w,{prop:"lowongan.posisi",label:"Posisi","min-width":"160"},{default:e(({row:l})=>{var d,D;return[n("div",null,[n("div",fe,u((d=l.lowongan)==null?void 0:d.posisi),1),n("small",he,u((D=l.lowongan)==null?void 0:D.perusahaan),1)])]}),_:1}),a(w,{prop:"tanggal_lamaran",label:"Tanggal",width:"120",sortable:"custom"},{default:e(({row:l})=>[r(u($(l.tanggal_lamaran)),1)]),_:1}),a(w,{prop:"status",label:"Status",width:"140"},{default:e(({row:l})=>[a(ga,{type:oa(l.status),size:"small"},{default:e(()=>[r(u(la(l.status)),1)]),_:2},1032,["type"])]),_:1}),a(w,{label:"Aksi",width:"160",fixed:"right"},{default:e(({row:l})=>[n("div",ve,[a(h,{tag:P(Fa),href:o.route("admin.lamaran.show",l.id),type:"primary",size:"small"},{default:e(()=>[r(" Detail ")]),_:2},1032,["tag","href"]),a(z,{trigger:"click"},{dropdown:e(()=>[a(j,null,{default:e(()=>[a(_,{onClick:d=>G(l.id,"diterima")},{default:e(()=>[r(" Terima ")]),_:2},1032,["onClick"]),a(_,{onClick:d=>G(l.id,"ditolak")},{default:e(()=>[r(" Tolak ")]),_:2},1032,["onClick"]),a(_,{onClick:d=>G(l.id,"interview")},{default:e(()=>[r(" Set Interview ")]),_:2},1032,["onClick"]),a(_,{divided:"",onClick:d=>ua(l.id),class:"text-danger"},{default:e(()=>[r(" Hapus ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:e(()=>[a(h,{type:"warning",size:"small"},{default:e(()=>[ke]),_:1})]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[ya,Y.value]])]),i.total>0?(v(),y("div",be,[n("div",ye,[n("div",we," Menampilkan "+u(i.from)+" - "+u(i.to)+" dari "+u(i.total)+" data ",1),a(ha,{"current-page":i.current_page,"onUpdate:currentPage":t[6]||(t[6]=l=>i.current_page=l),"page-size":i.per_page,total:i.total,onCurrentChange:ia,layout:"prev, pager, next",background:""},null,8,["current-page","page-size","total"])])])):S("",!0)])]),a(ka,{modelValue:C.value,"onUpdate:modelValue":t[12]||(t[12]=l=>C.value=l),title:"Export Laporan PDF",width:"600px","before-close":_a},{footer:e(()=>[n("span",Be,[a(h,{onClick:t[11]||(t[11]=l=>C.value=!1)},{default:e(()=>[r("Batal")]),_:1}),a(h,{type:"danger",onClick:ma,loading:U.value},{default:e(()=>[Fe,r(" Generate PDF ")]),_:1},8,["loading"])])]),default:e(()=>[a(va,{model:s,"label-position":"top",ref_key:"pdfExportFormRef",ref:ta},{default:e(()=>[a(Q,{title:"Export Laporan PDF",type:"info",description:"Pilih filter untuk menggenerate laporan PDF yang komprehensif dengan detail lengkap data lamaran.","show-icon":"",closable:!1,class:"mb-4"}),a(A,{gutter:16},{default:e(()=>[a(b,{span:12},{default:e(()=>[a(V,{label:"Filter Status"},{default:e(()=>[a(W,{modelValue:s.status,"onUpdate:modelValue":t[7]||(t[7]=l=>s.status=l),placeholder:"Pilih status (opsional)",clearable:"",style:{width:"100%"}},{default:e(()=>[(v(),y(K,null,N(x,(l,d)=>a(J,{key:d,label:l,value:d},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(b,{span:12},{default:e(()=>[a(V,{label:"Lowongan"},{default:e(()=>[a(q,{modelValue:s.lowongan_id,"onUpdate:modelValue":t[8]||(t[8]=l=>s.lowongan_id=l),placeholder:"ID Lowongan (opsional)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(A,{gutter:16},{default:e(()=>[a(b,{span:12},{default:e(()=>[a(V,{label:"Tanggal Mulai"},{default:e(()=>[a(B,{modelValue:s.tanggal_dari,"onUpdate:modelValue":t[9]||(t[9]=l=>s.tanggal_dari=l),type:"date",placeholder:"Pilih tanggal mulai",style:{width:"100%"},format:"DD/MM/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),a(b,{span:12},{default:e(()=>[a(V,{label:"Tanggal Akhir"},{default:e(()=>[a(B,{modelValue:s.tanggal_sampai,"onUpdate:modelValue":t[10]||(t[10]=l=>s.tanggal_sampai=l),type:"date",placeholder:"Pilih tanggal akhir",style:{width:"100%"},format:"DD/MM/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(V,{label:"Preview Filter"},{default:e(()=>[n("div",Ee,[n("div",xe,[s.status?(v(),y("div",De,[Ce,r(" "+u(x[s.status]),1)])):S("",!0),s.tanggal_dari||s.tanggal_sampai?(v(),y("div",Ve,[Se,r(" "+u(s.tanggal_dari?$(s.tanggal_dari):"Awal")+" - "+u(s.tanggal_sampai?$(s.tanggal_sampai):"Sekarang"),1)])):S("",!0),!s.status&&!s.tanggal_dari&&!s.tanggal_sampai?(v(),y("div",Pe,Te)):S("",!0)])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})}}},dt=wa(Ie,[["__scopeId","data-v-4288924b"]]);export{dt as default};
